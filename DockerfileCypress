ARG NODE_VERSION='18.20.3'
ARG YARN_VERSION='1.22.19'
ARG CHROME_VERSION='124.0.6367.60-1'
ARG CYPRESS_VERSION='12.0.0'

FROM cypress/factory:3.5.4

WORKDIR /opt/app
RUN npm install --save-dev cypress
RUN apt-get update; apt install -y curl python-is-python3 pkg-config build-essential
# Install Chromium and necessary dependencies for running Cypress
RUN apt-get update && apt-get install -y \
    chromium-browser \
    chromium-chromedriver \
    fonts-freefont-ttf \
    libgtk2.0-0 \
    libgtk-3-0 \
    libgbm-dev \
    libnotify-dev \
    libgconf-2-4 \
    libnss3 \
    libxss1 \
    libasound2 \
    libxtst6 \
    xauth \
    xvfb \
    # Clean up
    && rm -rf /var/lib/apt/lists/*
